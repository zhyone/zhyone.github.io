$(function(){function e(){d=window.innerWidth/2,h=window.innerHeight/2,o.aspect=window.innerWidth/window.innerHeight,o.updateProjectionMatrix(),s.setSize(window.innerWidth,window.innerHeight)}function t(e){p=e.clientX-d,E=e.clientY-h}function r(e){e.touches.length>1&&(p=e.touches[0].pageX-d)}function i(e){1==e.touches.length&&(p=e.touches[0].pageX-d)}function n(){requestAnimationFrame(n),o.position.x+=.05*(p-o.position.x),o.position.y+=.05*(200-E-o.position.y),o.lookAt(a.position),s.render(a,o)}var o,a,s,l=window.innerWidth,c=window.innerHeight,p=0,E=0,d=window.innerWidth/2,h=window.innerHeight/2;!function(){var n,p;(n=document.createElement("div")).style.position="fixed",n.style.top="0px",n.style.left="0px",n.style.zIndex="-1",n.style.opacity="0.5",document.body.appendChild(n),(o=new THREE.PerspectiveCamera(75,l/c,1,1e4)).position.z=1e3,a=new THREE.Scene,(s=new THREE.CanvasRenderer).setClearColor(16119801,0),s.setPixelRatio(window.devicePixelRatio),s.setSize(l,c),n.appendChild(s.domElement);for(var E=2*Math.PI,d=new THREE.SpriteCanvasMaterial({color:10263708,program:function(e){e.beginPath(),e.arc(0,0,.5,0,E,!0),e.fill()}}),h=0;h<1e3;h++)(p=new THREE.Sprite(d)).position.x=2*Math.random()-1,p.position.y=2*Math.random()-1,p.position.z=2*Math.random()-1,p.position.normalize(),p.position.multiplyScalar(10*Math.random()+450),p.scale.multiplyScalar(2),a.add(p);for(h=0;h<300;h++){var f=new THREE.Geometry,u=new THREE.Vector3(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1);u.normalize(),u.multiplyScalar(450),f.vertices.push(u);var m=u.clone();m.multiplyScalar(.3*Math.random()+1),f.vertices.push(m);var v=new THREE.Line(f,new THREE.LineBasicMaterial({color:10263708,opacity:Math.random()}));a.add(v)}document.addEventListener("mousemove",t,!1),document.addEventListener("touchstart",r,!1),document.addEventListener("touchmove",i,!1),window.addEventListener("resize",e,!1)}(),n()}),THREE.RenderableObject=function(){this.id=0,this.object=null,this.z=0,this.renderOrder=0},THREE.RenderableFace=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.v3=new THREE.RenderableVertex,this.normalModel=new THREE.Vector3,this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3],this.vertexNormalsLength=0,this.color=new THREE.Color,this.material=null,this.uvs=[new THREE.Vector2,new THREE.Vector2,new THREE.Vector2],this.z=0,this.renderOrder=0},THREE.RenderableVertex=function(){this.position=new THREE.Vector3,this.positionWorld=new THREE.Vector3,this.positionScreen=new THREE.Vector4,this.visible=!0},THREE.RenderableVertex.prototype.copy=function(e){this.positionWorld.copy(e.positionWorld),this.positionScreen.copy(e.positionScreen)},THREE.RenderableLine=function(){this.id=0,this.v1=new THREE.RenderableVertex,this.v2=new THREE.RenderableVertex,this.vertexColors=[new THREE.Color,new THREE.Color],this.material=null,this.z=0,this.renderOrder=0},THREE.RenderableSprite=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new THREE.Vector2,this.material=null,this.renderOrder=0},THREE.Projector=function(){function e(){if(s===R){var e=new THREE.RenderableVertex;return v.push(e),R++,s++,e}return v[s++]}function t(){if(c===y){var e=new THREE.RenderableFace;return x.push(e),y++,c++,e}return x[c++]}function r(){if(E===w){var e=new THREE.RenderableLine;return T.push(e),w++,E++,e}return T[E++]}function i(e,t){return e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id!==t.id?e.id-t.id:0}var n,o,a,s,l,c,p,E,d,h,f,u=[],m=0,v=[],R=0,x=[],y=0,T=[],w=0,H=[],g=0,S={objects:[],lights:[],elements:[]},M=new THREE.Vector3,C=new THREE.Vector4,b=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),z=new THREE.Box3,V=new Array(3),j=(new Array(4),new THREE.Matrix4),L=new THREE.Matrix4,O=new THREE.Matrix4,B=new THREE.Matrix3,W=new THREE.Frustum,P=new THREE.Vector4,k=new THREE.Vector4;this.projectVector=function(e,t){console.warn("THREE.Projector: .projectVector() is now vector.project()."),e.project(t)},this.unprojectVector=function(e,t){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),e.unproject(t)},this.pickingRay=function(e,t){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")};var N=new function(){function i(e){var t=e.position,r=e.positionWorld,i=e.positionScreen;r.copy(t).applyMatrix4(f),i.copy(r).applyMatrix4(L);var n=1/i.w;i.x*=n,i.y*=n,i.z*=n,e.visible=i.x>=-1&&i.x<=1&&i.y>=-1&&i.y<=1&&i.z>=-1&&i.z<=1}function n(e,t,r){return!0===e.visible||!0===t.visible||!0===r.visible||(V[0]=e.positionScreen,V[1]=t.positionScreen,V[2]=r.positionScreen,b.intersectsBox(z.setFromPoints(V)))}function o(e,t,r){return(r.positionScreen.x-e.positionScreen.x)*(t.positionScreen.y-e.positionScreen.y)-(r.positionScreen.y-e.positionScreen.y)*(t.positionScreen.x-e.positionScreen.x)<0}var s=[],c=[],E=null,d=null,h=new THREE.Matrix3;return{setObject:function(e){d=(E=e).material,h.getNormalMatrix(E.matrixWorld),s.length=0,c.length=0},projectVertex:i,checkTriangleVisibility:n,checkBackfaceCulling:o,pushVertex:function(t,r,n){(a=e()).position.set(t,r,n),i(a)},pushNormal:function(e,t,r){s.push(e,t,r)},pushUv:function(e,t){c.push(e,t)},pushLine:function(e,t){var i=v[e],n=v[t];(p=r()).id=E.id,p.v1.copy(i),p.v2.copy(n),p.z=(i.positionScreen.z+n.positionScreen.z)/2,p.renderOrder=E.renderOrder,p.material=E.material,S.elements.push(p)},pushTriangle:function(e,r,i){var a=v[e],p=v[r],f=v[i];if(!1!==n(a,p,f)&&(d.side===THREE.DoubleSide||!0===o(a,p,f))){(l=t()).id=E.id,l.v1.copy(a),l.v2.copy(p),l.v3.copy(f),l.z=(a.positionScreen.z+p.positionScreen.z+f.positionScreen.z)/3,l.renderOrder=E.renderOrder,l.normalModel.fromArray(s,3*e),l.normalModel.applyMatrix3(h).normalize();for(var u=0;u<3;u++){var m=l.vertexNormalsModel[u];m.fromArray(s,3*arguments[u]),m.applyMatrix3(h).normalize(),l.uvs[u].fromArray(c,2*arguments[u])}l.vertexNormalsLength=3,l.material=E.material,S.elements.push(l)}}}};this.projectScene=function(a,R,x,y){function T(e){(n=function(){if(o===m){var e=new THREE.RenderableObject;return u.push(e),m++,o++,e}return u[o++]}()).id=e.id,n.object=e,M.setFromMatrixPosition(e.matrixWorld),M.applyMatrix4(L),n.z=M.z,n.renderOrder=e.renderOrder,S.objects.push(n)}c=0,E=0,h=0,S.elements.length=0,!0===a.autoUpdate&&a.updateMatrixWorld(),null===R.parent&&R.updateMatrixWorld(),j.copy(R.matrixWorldInverse.getInverse(R.matrixWorld)),L.multiplyMatrices(R.projectionMatrix,j),W.setFromMatrix(L),o=0,S.objects.length=0,S.lights.length=0,a.traverseVisible(function(e){if(e instanceof THREE.Light)S.lights.push(e);else if(e instanceof THREE.Mesh||e instanceof THREE.Line){if(!1===e.material.visible)return;if(!0===e.frustumCulled&&!1===W.intersectsObject(e))return;T(e)}else if(e instanceof THREE.Sprite){if(!1===e.material.visible)return;if(!0===e.frustumCulled&&!1===W.intersectsSprite(e))return;T(e)}}),!0===x&&S.objects.sort(i);for(var w=0,b=S.objects.length;w<b;w++){var z=S.objects[w].object,V=z.geometry;if(N.setObject(z),f=z.matrixWorld,s=0,z instanceof THREE.Mesh){if(V instanceof THREE.BufferGeometry){var F=V.attributes,A=V.groups;if(void 0===F.position)continue;for(var I=0,D=(we=F.position.array).length;I<D;I+=3)N.pushVertex(we[I],we[I+1],we[I+2]);if(void 0!==F.normal)for(var G=F.normal.array,I=0,D=G.length;I<D;I+=3)N.pushNormal(G[I],G[I+1],G[I+2]);if(void 0!==F.uv)for(var U=F.uv.array,I=0,D=U.length;I<D;I+=2)N.pushUv(U[I],U[I+1]);if(null!==V.index){He=V.index.array;if(A.length>0)for(var q=0;q<A.length;q++)for(var X=A[q],I=X.start,D=X.start+X.count;I<D;I+=3)N.pushTriangle(He[I],He[I+1],He[I+2]);else for(var I=0,D=He.length;I<D;I+=3)N.pushTriangle(He[I],He[I+1],He[I+2])}else for(var I=0,D=we.length/3;I<D;I+=3)N.pushTriangle(I,I+1,I+2)}else if(V instanceof THREE.Geometry){var J=V.vertices,Y=V.faces,$=V.faceVertexUvs[0];B.getNormalMatrix(f);for(var K=z.material,Q=K instanceof THREE.MultiMaterial,Z=!0===Q?z.material:null,_=0,ee=J.length;_<ee;_++){var te=J[_];if(M.copy(te),!0===K.morphTargets)for(var re=V.morphTargets,ie=z.morphTargetInfluences,ne=0,oe=re.length;ne<oe;ne++){var ae=ie[ne];if(0!==ae){var se=re[ne].vertices[_];M.x+=(se.x-te.x)*ae,M.y+=(se.y-te.y)*ae,M.z+=(se.z-te.z)*ae}}N.pushVertex(M.x,M.y,M.z)}for(var le=0,ce=Y.length;le<ce;le++){var pe=Y[le];if(void 0!==(K=!0===Q?Z.materials[pe.materialIndex]:z.material)){var Ee=K.side,de=v[pe.a],he=v[pe.b],fe=v[pe.c];if(!1!==N.checkTriangleVisibility(de,he,fe)){var ue=N.checkBackfaceCulling(de,he,fe);if(Ee!==THREE.DoubleSide){if(Ee===THREE.FrontSide&&!1===ue)continue;if(Ee===THREE.BackSide&&!0===ue)continue}(l=t()).id=z.id,l.v1.copy(de),l.v2.copy(he),l.v3.copy(fe),l.normalModel.copy(pe.normal),!1!==ue||Ee!==THREE.BackSide&&Ee!==THREE.DoubleSide||l.normalModel.negate(),l.normalModel.applyMatrix3(B).normalize();for(var me=pe.vertexNormals,ve=0,Re=Math.min(me.length,3);ve<Re;ve++){var xe=l.vertexNormalsModel[ve];xe.copy(me[ve]),!1!==ue||Ee!==THREE.BackSide&&Ee!==THREE.DoubleSide||xe.negate(),xe.applyMatrix3(B).normalize()}l.vertexNormalsLength=me.length;var ye=$[le];if(void 0!==ye)for(var Te=0;Te<3;Te++)l.uvs[Te].copy(ye[Te]);l.color=pe.color,l.material=K,l.z=(de.positionScreen.z+he.positionScreen.z+fe.positionScreen.z)/3,l.renderOrder=z.renderOrder,S.elements.push(l)}}}}}else if(z instanceof THREE.Line){if(V instanceof THREE.BufferGeometry){if(void 0!==(F=V.attributes).position){for(var we=F.position.array,I=0,D=we.length;I<D;I+=3)N.pushVertex(we[I],we[I+1],we[I+2]);if(null!==V.index)for(var He,I=0,D=(He=V.index.array).length;I<D;I+=2)N.pushLine(He[I],He[I+1]);else for(var ge=z instanceof THREE.LineSegments?2:1,I=0,D=we.length/3-1;I<D;I+=ge)N.pushLine(I,I+1)}}else if(V instanceof THREE.Geometry){O.multiplyMatrices(L,f);if(0===(J=z.geometry.vertices).length)continue;(de=e()).positionScreen.copy(J[0]).applyMatrix4(O);for(var ge=z instanceof THREE.LineSegments?2:1,_=1,ee=J.length;_<ee;_++)(de=e()).positionScreen.copy(J[_]).applyMatrix4(O),(_+1)%ge>0||(he=v[s-2],P.copy(de.positionScreen),k.copy(he.positionScreen),!0===function(e,t){var r=0,i=1,n=e.z+e.w,o=t.z+t.w,a=-e.z+e.w,s=-t.z+t.w;return n>=0&&o>=0&&a>=0&&s>=0||!(n<0&&o<0||a<0&&s<0)&&(n<0?r=Math.max(r,n/(n-o)):o<0&&(i=Math.min(i,n/(n-o))),a<0?r=Math.max(r,a/(a-s)):s<0&&(i=Math.min(i,a/(a-s))),!(i<r||(e.lerp(t,r),t.lerp(e,1-i),0)))}(P,k)&&(P.multiplyScalar(1/P.w),k.multiplyScalar(1/k.w),(p=r()).id=z.id,p.v1.positionScreen.copy(P),p.v2.positionScreen.copy(k),p.z=Math.max(P.z,k.z),p.renderOrder=z.renderOrder,p.material=z.material,z.material.vertexColors===THREE.VertexColors&&(p.vertexColors[0].copy(z.geometry.colors[_]),p.vertexColors[1].copy(z.geometry.colors[_-1])),S.elements.push(p)))}}else if(z instanceof THREE.Sprite){C.set(f.elements[12],f.elements[13],f.elements[14],1),C.applyMatrix4(L);var Se=1/C.w;C.z*=Se,C.z>=-1&&C.z<=1&&((d=function(){if(h===g){var e=new THREE.RenderableSprite;return H.push(e),g++,h++,e}return H[h++]}()).id=z.id,d.x=C.x*Se,d.y=C.y*Se,d.z=C.z,d.renderOrder=z.renderOrder,d.object=z,d.rotation=z.rotation,d.scale.x=z.scale.x*Math.abs(d.x-(C.x+R.projectionMatrix.elements[0])/(C.w+R.projectionMatrix.elements[12])),d.scale.y=z.scale.y*Math.abs(d.y-(C.y+R.projectionMatrix.elements[5])/(C.w+R.projectionMatrix.elements[13])),d.material=z.material,S.elements.push(d))}}return!0===y&&S.elements.sort(i),S}},THREE.SpriteCanvasMaterial=function(e){THREE.Material.call(this),this.type="SpriteCanvasMaterial",this.color=new THREE.Color(16777215),this.program=function(e,t){},this.setValues(e)},THREE.SpriteCanvasMaterial.prototype=Object.create(THREE.Material.prototype),THREE.SpriteCanvasMaterial.prototype.constructor=THREE.SpriteCanvasMaterial,THREE.SpriteCanvasMaterial.prototype.clone=function(){var e=new THREE.SpriteCanvasMaterial;return e.copy(this),e.color.copy(this.color),e.program=this.program,e},THREE.CanvasRenderer=function(e){function t(e,t,r){for(var i=0,n=R.length;i<n;i++){var o=R[i];if(le.copy(o.color),o instanceof THREE.DirectionalLight){a=me.setFromMatrixPosition(o.matrixWorld).normalize();if((s=t.dot(a))<=0)continue;s*=o.intensity,r.add(le.multiplyScalar(s))}else if(o instanceof THREE.PointLight){var a=me.setFromMatrixPosition(o.matrixWorld),s=t.dot(me.subVectors(a,e).normalize());if(s<=0)continue;if(0==(s*=0==o.distance?1:1-Math.min(e.distanceTo(a)/o.distance,1)))continue;s*=o.intensity,r.add(le.multiplyScalar(s))}}}function r(e,r,o,s,p,E,d,h){if(P.info.render.vertices+=3,P.info.render.faces++,l(h.opacity),c(h.blending),H=e.positionScreen.x,g=e.positionScreen.y,S=r.positionScreen.x,M=r.positionScreen.y,C=o.positionScreen.x,b=o.positionScreen.y,function(e,t,r,i,n,o){Y.beginPath(),Y.moveTo(e,t),Y.lineTo(r,i),Y.lineTo(n,o),Y.closePath()}(H,g,S,M,C,b),(h instanceof THREE.MeshLambertMaterial||h instanceof THREE.MeshPhongMaterial)&&null===h.map)ae.copy(h.color),se.copy(h.emissive),h.vertexColors===THREE.FaceColors&&ae.multiply(d.color),oe.copy(he),ve.copy(e.positionWorld).add(r.positionWorld).add(o.positionWorld).divideScalar(3),t(ve,d.normalModel,oe),oe.multiply(ae).add(se),!0===h.wireframe?i(oe,h.wireframeLinewidth,h.wireframeLinecap,h.wireframeLinejoin):n(oe);else if(h instanceof THREE.MeshBasicMaterial||h instanceof THREE.MeshLambertMaterial||h instanceof THREE.MeshPhongMaterial)if(null!==h.map){h.map.mapping===THREE.UVMapping&&(z=d.uvs,a(H,g,S,M,C,b,z[s].x,z[s].y,z[p].x,z[p].y,z[E].x,z[E].y,h.map))}else null!==h.envMap?h.envMap.mapping===THREE.SphericalReflectionMapping&&(Re.copy(d.vertexNormalsModel[s]).applyMatrix3(xe),V=.5*Re.x+.5,j=.5*Re.y+.5,Re.copy(d.vertexNormalsModel[p]).applyMatrix3(xe),L=.5*Re.x+.5,O=.5*Re.y+.5,Re.copy(d.vertexNormalsModel[E]).applyMatrix3(xe),B=.5*Re.x+.5,W=.5*Re.y+.5,a(H,g,S,M,C,b,V,j,L,O,B,W,h.envMap)):(oe.copy(h.color),h.vertexColors===THREE.FaceColors&&oe.multiply(d.color),!0===h.wireframe?i(oe,h.wireframeLinewidth,h.wireframeLinecap,h.wireframeLinejoin):n(oe));else h instanceof THREE.MeshNormalMaterial?(Re.copy(d.normalModel).applyMatrix3(xe),oe.setRGB(Re.x,Re.y,Re.z).multiplyScalar(.5).addScalar(.5),!0===h.wireframe?i(oe,h.wireframeLinewidth,h.wireframeLinecap,h.wireframeLinejoin):n(oe)):(oe.setRGB(1,1,1),!0===h.wireframe?i(oe,h.wireframeLinewidth,h.wireframeLinecap,h.wireframeLinejoin):n(oe))}function i(e,t,r,i){p(t),E(r),d(i),h(e.getStyle()),Y.stroke(),de.expandByScalar(2*t)}function n(e){f(e.getStyle()),Y.fill()}function o(e){if(0===e.version||e instanceof THREE.CompressedTexture||e instanceof THREE.DataTexture)return{canvas:void 0,version:e.version};var t=e.image;if(!1===t.complete)return{canvas:void 0,version:0};var r=e.wrapS===THREE.RepeatWrapping||e.wrapS===THREE.MirroredRepeatWrapping,i=e.wrapT===THREE.RepeatWrapping||e.wrapT===THREE.MirroredRepeatWrapping,n=e.wrapS===THREE.MirroredRepeatWrapping,o=e.wrapT===THREE.MirroredRepeatWrapping,a=document.createElement("canvas");a.width=t.width*(n?2:1),a.height=t.height*(o?2:1);var s=a.getContext("2d");s.setTransform(1,0,0,-1,0,t.height),s.drawImage(t,0,0),!0===n&&(s.setTransform(-1,0,0,-1,t.width,t.height),s.drawImage(t,-t.width,0)),!0===o&&(s.setTransform(1,0,0,1,0,0),s.drawImage(t,0,t.height)),!0===n&&!0===o&&(s.setTransform(-1,0,0,1,t.width,0),s.drawImage(t,-t.width,t.height));var l="no-repeat";!0===r&&!0===i?l="repeat":!0===r?l="repeat-x":!0===i&&(l="repeat-y");var c=Y.createPattern(a,l);return e.onUpdate&&e.onUpdate(e),{canvas:c,version:e.version}}function a(e,t,r,i,n,a,s,l,c,p,E,d,h){var u=ce[h.id];if(void 0!==u&&u.version===h.version||(u=o(h),ce[h.id]=u),void 0===u.canvas)return f("rgba( 0, 0, 0, 1)"),void Y.fill();f(u.canvas);var m,v,R,x,y,T,w,H,g=h.offset.x/h.repeat.x,S=h.offset.y/h.repeat.y,M=h.image.width*h.repeat.x,C=h.image.height*h.repeat.y;c=(c+g)*M,p=(p+S)*C,E=(E+g)*M,d=(d+S)*C,r-=e,i-=t,n-=e,a-=t,0!==(w=(c-=s=(s+g)*M)*(d-=l=(l+S)*C)-(E-=s)*(p-=l))&&(y=e-(m=(d*r-p*n)*(H=1/w))*s-(R=(c*n-E*r)*H)*l,T=t-(v=(d*i-p*a)*H)*s-(x=(c*a-E*i)*H)*l,Y.save(),Y.transform(m,v,R,x,y,T),Y.fill(),Y.restore())}function s(e,t,r){var i,n=t.x-e.x,o=t.y-e.y,a=n*n+o*o;0!==a&&(n*=i=r/Math.sqrt(a),o*=i,t.x+=n,t.y+=o,e.x-=n,e.y-=o)}function l(e){Q!==e&&(Y.globalAlpha=e,Q=e)}function c(e){Z!==e&&(e===THREE.NormalBlending?Y.globalCompositeOperation="source-over":e===THREE.AdditiveBlending?Y.globalCompositeOperation="lighter":e===THREE.SubtractiveBlending?Y.globalCompositeOperation="darker":e===THREE.MultiplyBlending&&(Y.globalCompositeOperation="multiply"),Z=e)}function p(e){te!==e&&(Y.lineWidth=e,te=e)}function E(e){re!==e&&(Y.lineCap=e,re=e)}function d(e){ie!==e&&(Y.lineJoin=e,ie=e)}function h(e){_!==e&&(Y.strokeStyle=e,_=e)}function f(e){ee!==e&&(Y.fillStyle=e,ee=e)}function u(e){ne.length!==e.length&&(Y.setLineDash(e),ne=e)}console.log("THREE.CanvasRenderer",THREE.REVISION),e=e||{};var m,v,R,x,y,T,w,H,g,S,M,C,b,z,V,j,L,O,B,W,P=this,k=new THREE.Projector,N=void 0!==e.canvas?e.canvas:document.createElement("canvas"),F=N.width,A=N.height,I=Math.floor(F/2),D=Math.floor(A/2),G=0,U=0,q=F,X=A,J=1,Y=N.getContext("2d",{alpha:!0===e.alpha}),$=new THREE.Color(0),K=!0===e.alpha?0:1,Q=1,Z=0,_=null,ee=null,te=null,re=null,ie=null,ne=[],oe=(new THREE.RenderableVertex,new THREE.RenderableVertex,new THREE.Color),ae=(new THREE.Color,new THREE.Color,new THREE.Color,new THREE.Color,new THREE.Color),se=new THREE.Color,le=new THREE.Color,ce={},pe=new THREE.Box2,Ee=new THREE.Box2,de=new THREE.Box2,he=new THREE.Color,fe=new THREE.Color,ue=new THREE.Color,me=new THREE.Vector3,ve=new THREE.Vector3,Re=new THREE.Vector3,xe=new THREE.Matrix3;void 0===Y.setLineDash&&(Y.setLineDash=function(){}),this.domElement=N,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.info={render:{vertices:0,faces:0}},this.supportsVertexTextures=function(){},this.setFaceCulling=function(){},this.getContext=function(){return Y},this.getContextAttributes=function(){return Y.getContextAttributes()},this.getPixelRatio=function(){return J},this.setPixelRatio=function(e){void 0!==e&&(J=e)},this.setSize=function(e,t,r){F=e*J,A=t*J,N.width=F,N.height=A,I=Math.floor(F/2),D=Math.floor(A/2),!1!==r&&(N.style.width=e+"px",N.style.height=t+"px"),pe.min.set(-I,-D),pe.max.set(I,D),Ee.min.set(-I,-D),Ee.max.set(I,D),Q=1,Z=0,_=null,ee=null,te=null,re=null,ie=null,this.setViewport(0,0,e,t)},this.setViewport=function(e,t,r,i){G=e*J,U=t*J,q=r*J,X=i*J},this.setScissor=function(){},this.setScissorTest=function(){},this.setClearColor=function(e,t){$.set(e),K=void 0!==t?t:1,Ee.min.set(-I,-D),Ee.max.set(I,D)},this.setClearColorHex=function(e,t){console.warn("THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead."),this.setClearColor(e,t)},this.getClearColor=function(){return $},this.getClearAlpha=function(){return K},this.getMaxAnisotropy=function(){return 0},this.clear=function(){!1===Ee.isEmpty()&&(Ee.intersect(pe),Ee.expandByScalar(2),Ee.min.x=Ee.min.x+I,Ee.min.y=-Ee.min.y+D,Ee.max.x=Ee.max.x+I,Ee.max.y=-Ee.max.y+D,K<1&&Y.clearRect(0|Ee.min.x,0|Ee.max.y,Ee.max.x-Ee.min.x|0,Ee.min.y-Ee.max.y|0),K>0&&(c(THREE.NormalBlending),l(1),f("rgba("+Math.floor(255*$.r)+","+Math.floor(255*$.g)+","+Math.floor(255*$.b)+","+K+")"),Y.fillRect(0|Ee.min.x,0|Ee.max.y,Ee.max.x-Ee.min.x|0,Ee.min.y-Ee.max.y|0)),Ee.makeEmpty())},this.clearColor=function(){},this.clearDepth=function(){},this.clearStencil=function(){},this.render=function(e,t){if(t instanceof THREE.Camera!=!1){var i=e.background;i&&i.isColor?(f("rgb("+Math.floor(255*i.r)+","+Math.floor(255*i.g)+","+Math.floor(255*i.b)+")"),Y.fillRect(0,0,F,A)):!0===this.autoClear&&this.clear(),P.info.render.vertices=0,P.info.render.faces=0,Y.setTransform(q/F,0,0,-X/A,G,A-U),Y.translate(I,D),m=k.projectScene(e,t,this.sortObjects,this.sortElements),v=m.elements,R=m.lights,x=t,xe.getNormalMatrix(t.matrixWorldInverse),function(){he.setRGB(0,0,0),fe.setRGB(0,0,0),ue.setRGB(0,0,0);for(var e=0,t=R.length;e<t;e++){var r=R[e],i=r.color;r instanceof THREE.AmbientLight?he.add(i):r instanceof THREE.DirectionalLight?fe.add(i):r instanceof THREE.PointLight&&ue.add(i)}}();for(var n=0,a=v.length;n<a;n++){var H=v[n],g=H.material;if(void 0!==g&&0!==g.opacity){if(de.makeEmpty(),H instanceof THREE.RenderableSprite)(y=H).x*=I,y.y*=D,function(e,t,r){l(r.opacity),c(r.blending);var i=t.scale.x*I,n=t.scale.y*D,a=.5*Math.sqrt(i*i+n*n);if(de.min.set(e.x-a,e.y-a),de.max.set(e.x+a,e.y+a),r instanceof THREE.SpriteMaterial){var s=r.map;if(null!==s){var p=ce[s.id];if(void 0!==p&&p.version===s.version||(p=o(s),ce[s.id]=p),void 0!==p.canvas){f(p.canvas);var E=s.image,d=E.width*s.offset.x,u=E.height*s.offset.y,m=E.width*s.repeat.x,v=E.height*s.repeat.y,R=i/m,x=n/v;Y.save(),Y.translate(e.x,e.y),0!==r.rotation&&Y.rotate(r.rotation),Y.translate(-i/2,-n/2),Y.scale(R,x),Y.translate(-d,-u),Y.fillRect(d,u,m,v),Y.restore()}}else f(r.color.getStyle()),Y.save(),Y.translate(e.x,e.y),0!==r.rotation&&Y.rotate(r.rotation),Y.scale(i,-n),Y.fillRect(-.5,-.5,1,1),Y.restore()}else r instanceof THREE.SpriteCanvasMaterial&&(h(r.color.getStyle()),f(r.color.getStyle()),Y.save(),Y.translate(e.x,e.y),0!==r.rotation&&Y.rotate(r.rotation),Y.scale(i,n),r.program(Y),Y.restore())}(y,H,g);else if(H instanceof THREE.RenderableLine)y=H.v1,T=H.v2,y.positionScreen.x*=I,y.positionScreen.y*=D,T.positionScreen.x*=I,T.positionScreen.y*=D,de.setFromPoints([y.positionScreen,T.positionScreen]),!0===pe.intersectsBox(de)&&function(e,t,r,i){if(l(i.opacity),c(i.blending),Y.beginPath(),Y.moveTo(e.positionScreen.x,e.positionScreen.y),Y.lineTo(t.positionScreen.x,t.positionScreen.y),i instanceof THREE.LineBasicMaterial){if(p(i.linewidth),E(i.linecap),d(i.linejoin),i.vertexColors!==THREE.VertexColors)h(i.color.getStyle());else{var n=r.vertexColors[0].getStyle(),o=r.vertexColors[1].getStyle();if(n===o)h(n);else{try{var a=Y.createLinearGradient(e.positionScreen.x,e.positionScreen.y,t.positionScreen.x,t.positionScreen.y);a.addColorStop(0,n),a.addColorStop(1,o)}catch(e){a=n}h(a)}}Y.stroke(),de.expandByScalar(2*i.linewidth)}else i instanceof THREE.LineDashedMaterial&&(p(i.linewidth),E(i.linecap),d(i.linejoin),h(i.color.getStyle()),u([i.dashSize,i.gapSize]),Y.stroke(),de.expandByScalar(2*i.linewidth),u([]))}(y,T,H,g);else if(H instanceof THREE.RenderableFace){if(y=H.v1,T=H.v2,w=H.v3,y.positionScreen.z<-1||y.positionScreen.z>1)continue;if(T.positionScreen.z<-1||T.positionScreen.z>1)continue;if(w.positionScreen.z<-1||w.positionScreen.z>1)continue;y.positionScreen.x*=I,y.positionScreen.y*=D,T.positionScreen.x*=I,T.positionScreen.y*=D,w.positionScreen.x*=I,w.positionScreen.y*=D,g.overdraw>0&&(s(y.positionScreen,T.positionScreen,g.overdraw),s(T.positionScreen,w.positionScreen,g.overdraw),s(w.positionScreen,y.positionScreen,g.overdraw)),de.setFromPoints([y.positionScreen,T.positionScreen,w.positionScreen]),!0===pe.intersectsBox(de)&&r(y,T,w,0,1,2,H,g)}Ee.union(de)}}Y.setTransform(1,0,0,1,0,0)}else console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.")}};